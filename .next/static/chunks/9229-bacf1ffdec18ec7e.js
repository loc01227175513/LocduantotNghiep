"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9229],{69229:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var r,s=a(95155),n=a(12115),o=a(60289),l=a(13201),i=a(81292),c=a(44608),d=a(79026),u=a(3256),h=a(80760);let m=(0,n.createContext)(()=>{});function p(e){let{value:t,children:a}=e;return n.createElement(m.Provider,{value:t},a)}var g=a(64254),x=a(73854),f=a(93270),y=a(42572),w=a(63593);let b=null!=(r=n.startTransition)?r:function(e){e()};var v=a(9257),j=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(j||{}),N=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))(N||{});let E={0:e=>({...e,disclosureState:(0,f.Y)(e.disclosureState,{0:1,1:0})}),1:e=>1===e.disclosureState?e:{...e,disclosureState:1},2:(e,t)=>e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId},3:(e,t)=>e.panelId===t.panelId?e:{...e,panelId:t.panelId},4:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},5:(e,t)=>e.panelElement===t.element?e:{...e,panelElement:t.element}},S=(0,n.createContext)(null);function k(e){let t=(0,n.useContext)(S);if(null===t){let t=Error("<".concat(e," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,k),t}return t}S.displayName="DisclosureContext";let I=(0,n.createContext)(null);I.displayName="DisclosureAPIContext";let P=(0,n.createContext)(null);function C(e,t){return(0,f.Y)(t.type,E,e,t)}P.displayName="DisclosurePanelContext";let D=n.Fragment,T=w.Ac.RenderStrategy|w.Ac.Static,_=(0,w.FX)(function(e,t){let{defaultOpen:a=!1,...r}=e,s=(0,n.useRef)(null),o=(0,u.P)(t,(0,u.a)(e=>{s.current=e},void 0===e.as||e.as===n.Fragment)),l=(0,n.useReducer)(C,{disclosureState:a?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:i,buttonId:d},h]=l,m=(0,c._)(e=>{h({type:1});let t=(0,y.T)(s);if(!t||!d)return;let a=e?e instanceof HTMLElement?e:e.current instanceof HTMLElement?e.current:t.getElementById(d):t.getElementById(d);null==a||a.focus()}),x=(0,n.useMemo)(()=>({close:m}),[m]),b=(0,n.useMemo)(()=>({open:0===i,close:m}),[i,m]),v=(0,w.Ci)();return n.createElement(S.Provider,{value:l},n.createElement(I.Provider,{value:x},n.createElement(p,{value:m},n.createElement(g.El,{value:(0,f.Y)(i,{0:g.Uw.Open,1:g.Uw.Closed})},v({ourProps:{ref:o},theirProps:r,slot:b,defaultTag:D,name:"Disclosure"})))))}),F=(0,w.FX)(function(e,t){let a=(0,n.useId)(),{id:r="headlessui-disclosure-button-".concat(a),disabled:s=!1,autoFocus:h=!1,...m}=e,[p,g]=k("Disclosure.Button"),f=(0,n.useContext)(P),y=null!==f&&f===p.panelId,b=(0,n.useRef)(null),j=(0,u.P)(b,t,(0,c._)(e=>{if(!y)return g({type:4,element:e})}));(0,n.useEffect)(()=>{if(!y)return g({type:2,buttonId:r}),()=>{g({type:2,buttonId:null})}},[r,g,y]);let N=(0,c._)(e=>{var t;if(y){if(1===p.disclosureState)return;switch(e.key){case v.D.Space:case v.D.Enter:e.preventDefault(),e.stopPropagation(),g({type:0}),null==(t=p.buttonElement)||t.focus()}}else switch(e.key){case v.D.Space:case v.D.Enter:e.preventDefault(),e.stopPropagation(),g({type:0})}}),E=(0,c._)(e=>{e.key===v.D.Space&&e.preventDefault()}),S=(0,c._)(e=>{var t;(0,x.l)(e.currentTarget)||s||(y?(g({type:0}),null==(t=p.buttonElement)||t.focus()):g({type:0}))}),{isFocusVisible:I,focusProps:C}=(0,o.o)({autoFocus:h}),{isHovered:D,hoverProps:T}=(0,l.M)({isDisabled:s}),{pressed:_,pressProps:F}=(0,i.Z)({disabled:s}),B=(0,n.useMemo)(()=>({open:0===p.disclosureState,hover:D,active:_,disabled:s,focus:I,autofocus:h}),[p,D,_,I,s,h]),O=(0,d.c)(e,p.buttonElement),R=y?(0,w.v6)({ref:j,type:O,disabled:s||void 0,autoFocus:h,onKeyDown:N,onClick:S},C,T,F):(0,w.v6)({ref:j,id:r,type:O,"aria-expanded":0===p.disclosureState,"aria-controls":p.panelElement?p.panelId:void 0,disabled:s||void 0,autoFocus:h,onKeyDown:N,onKeyUp:E,onClick:S},C,T,F);return(0,w.Ci)()({ourProps:R,theirProps:m,slot:B,defaultTag:"button",name:"Disclosure.Button"})}),B=(0,w.FX)(function(e,t){let a=(0,n.useId)(),{id:r="headlessui-disclosure-panel-".concat(a),transition:s=!1,...o}=e,[l,i]=k("Disclosure.Panel"),{close:d}=function e(t){let a=(0,n.useContext)(I);if(null===a){let a=Error("<".concat(t," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(a,e),a}return a}("Disclosure.Panel"),[m,p]=(0,n.useState)(null),x=(0,u.P)(t,(0,c._)(e=>{b(()=>i({type:5,element:e}))}),p);(0,n.useEffect)(()=>(i({type:3,panelId:r}),()=>{i({type:3,panelId:null})}),[r,i]);let f=(0,g.O_)(),[y,v]=(0,h.p)(s,m,null!==f?(f&g.Uw.Open)===g.Uw.Open:0===l.disclosureState),j=(0,n.useMemo)(()=>({open:0===l.disclosureState,close:d}),[l.disclosureState,d]),N={ref:x,id:r,...(0,h.B)(v)},E=(0,w.Ci)();return n.createElement(g.$x,null,n.createElement(P.Provider,{value:l.panelId},E({ourProps:N,theirProps:o,slot:j,defaultTag:"div",features:T,visible:y,name:"Disclosure.Panel"})))}),O=Object.assign(_,{Button:F,Panel:B}),R=n.forwardRef(function(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,n.createElement("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"}))}),M=n.forwardRef(function(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,n.createElement("path",{fillRule:"evenodd",d:"M4 10a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 10Z",clipRule:"evenodd"}))});var A=a(28424),U=a(82651);function Y(){let e=null;e=new URLSearchParams(window.location.search).get("id");let[t,a]=(0,n.useState)(null),[r,o]=(0,n.useState)(0),[l,i]=(0,n.useState)(null),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[m,p]=(0,n.useState)({}),g=(0,n.useRef)(null),x=null;window.localStorage&&(x=JSON.parse(window.localStorage?localStorage.getItem("data"):null)),(0,n.useEffect)(()=>{let e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},[]),(0,n.useEffect)(()=>{(async()=>{try{let t=(await U.A.get("http://huuphuoc.id.vn/api/Khoahocchitiet/".concat(e))).data.khoahoc;if(a(t),t.baihocs.length>0){let e=t.baihocs[0].video[0];e&&(d(e.url_link),i(e.id))}let r=t.baihocs.reduce((e,t)=>e+t.video.reduce((e,t)=>{let[a,r,s]=t.thoiluong.split(":").map(Number);return e+3600*a+60*r+s},0),0);o(r)}catch(e){console.error("Error fetching course details:",e)}})()},[e]);let f=(0,n.useCallback)(async e=>{if(e.data===window.YT.PlayerState.ENDED){if(h(!0),x&&l)try{let e={trangthai:"Đ\xe3 xem",id_nguoidung:x.id,id_video:l};console.log("Request Data:",e);let t=await U.A.post("http://huuphuoc.id.vn/api/videodahoc",e);console.log("Video đ\xe3 học",t),p(e=>({...e,[l]:!0}))}catch(e){e.response?(console.error("Error response:",e.response.data),console.error("Error status:",e.response.status),console.error("Error headers:",e.response.headers)):e.request?console.error("Error request:",e.request):console.error("Error message:",e.message),console.error("Error config:",e.config)}else console.error("Missing parsedData or currentVideoId")}},[x,l,p,h]),y=(0,n.useCallback)(()=>{window.YT?g.current=new window.YT.Player("player",{events:{onStateChange:f},videoId:c.split("/").pop()}):window.onYouTubeIframeAPIReady=()=>{g.current=new window.YT.Player("player",{events:{onStateChange:f},videoId:c.split("/").pop()})}},[c,f]);(0,n.useEffect)(()=>{c&&y()},[c,y]),(0,n.useEffect)(()=>{(async()=>{if(!l||!t){console.log("currentVideoId or khoahoc is not defined");return}try{let e=await U.A.get("http://huuphuoc.id.vn/api/kiemtravidedahoc");if(Array.isArray(e.data.data)){let a={...m};t.baihocs.forEach(t=>{t.video.forEach(t=>{console.log("Checking video:",e.data.data),e.data.data.some(e=>e.id_video===t.id)&&(a[t.id]=!0)})}),p(a)}else console.error("Error: response.data.data is not an array")}catch(e){console.error("Error checking video watched status:",e)}})()},[l,t,m]);let w=(e,t)=>{d(e),i(t),h(!1)},b=async(t,a)=>{try{let r=window.localStorage?localStorage.getItem("data"):null,s=JSON.parse(r);if(!s){alert("User not found. Please log in.");return}let n={id_nguoidung:s.id,id_khoahoc:e,danhgia:a,noidung:t},o=await U.A.post("http://huuphuoc.id.vn/api/danhgia",n);200===o.status?(alert("B\xecnh luận th\xe0nh c\xf4ng!"),window.location.reload()):alert("B\xecnh luận thất bại.")}catch(e){e.response&&409===e.response.status?alert("Course is already in the cart."):(console.error("Error adding course to cart:",e.response?e.response.data:e.message),alert("Failed to add course to cart."))}},v=async()=>{await (0,A.fT)()};return(t?t.baihocs.length:"No data")===Object.keys(m).length&&v(),(0,s.jsx)("div",{className:"container mx-auto px-4 py-8 bg-gray-100 min-h-screen mt-60 mb-60",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,s.jsxs)("div",{className:"flex-grow lg:pr-8",children:[(0,s.jsxs)("div",{className:"relative pb-[56.25%]",children:[(0,s.jsx)("iframe",{id:"player",className:"absolute top-0 left-0 w-full h-full rounded-lg shadow-lg",src:c?"https://www.youtube.com/embed/".concat(c,"?enablejsapi=1"):"",allowFullScreen:!0,title:"YouTube Video"}),u&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-green-200 bg-opacity-75 rounded-lg",children:(0,s.jsx)("span",{className:"text-xl font-semibold text-green-800",children:"Video đ\xe3 xem xong!"})})]}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-between border-b border-gray-300 pb-4",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:t.ten}),(0,s.jsxs)("p",{className:"text-2xl font-semibold text-indigo-600",children:["$",t.gia]})]}),(0,s.jsxs)("section",{"aria-labelledby":"course-description",className:"mt-6",children:[(0,s.jsxs)(O,{children:[(0,s.jsxs)(F,{className:"w-full flex justify-between items-center px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50",children:[(0,s.jsx)("span",{className:"text-lg font-medium text-gray-800",children:"M\xf4 tả kh\xf3a học"}),(0,s.jsx)(R,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:hidden"}),(0,s.jsx)(M,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:block hidden"})]}),(0,s.jsx)(B,{className:"mt-2 px-4 py-2 bg-gray-50 rounded-lg shadow-inner",children:(0,s.jsx)("p",{className:"text-gray-700",children:t.mota})})]}),(0,s.jsxs)(O,{as:"div",className:"mt-4",children:[(0,s.jsxs)(F,{className:"w-full flex justify-between items-center px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50",children:[(0,s.jsx)("span",{className:"text-lg font-medium text-gray-800",children:"B\xecnh luận"}),(0,s.jsx)(R,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:hidden"}),(0,s.jsx)(M,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:block hidden"})]}),(0,s.jsxs)(B,{className:"mt-2 px-4 py-2 bg-gray-50 rounded-lg shadow-inner",children:[t.danhgia&&t.danhgia.map(e=>(0,s.jsxs)("div",{className:"mb-4 p-4 bg-white rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold text-yellow-500 mr-2",children:[e.rating," ★"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["by ",e.user]})]}),(0,s.jsx)("p",{className:"text-gray-700",children:e.comment})]},e.id)),(0,s.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let t=e.target.comment.value,a=e.target.rating.value;await b(t,a)},className:"mt-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700",children:"Comment"}),(0,s.jsx)("textarea",{id:"comment",name:"comment",rows:"4",className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rating",className:"block text-sm font-medium text-gray-700",children:"Rating"}),(0,s.jsxs)("select",{id:"rating",name:"rating",className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select a rating"}),(0,s.jsx)("option",{value:"1",children:"1"}),(0,s.jsx)("option",{value:"2",children:"2"}),(0,s.jsx)("option",{value:"3",children:"3"}),(0,s.jsx)("option",{value:"4",children:"4"}),(0,s.jsx)("option",{value:"5",children:"5"})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit"})})]})]})]}),(0,s.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,s.jsxs)("p",{className:"text-lg font-medium text-gray-800",children:["Instructor: ",(0,s.jsx)("span",{className:"font-normal text-gray-600",children:t.giangvien})]}),(0,s.jsxs)("p",{className:"text-lg font-medium text-gray-800",children:["Category: ",(0,s.jsx)("span",{className:"font-normal text-gray-600",children:t.theloai})]}),(0,s.jsxs)("p",{className:"text-lg font-medium text-gray-800",children:["Sub-category: ",(0,s.jsx)("span",{className:"font-normal text-gray-600",children:t.theloaicon})]}),(0,s.jsxs)("p",{className:"text-lg font-medium text-gray-800",children:["Thời lượng: ",(0,s.jsx)("span",{className:"font-normal text-gray-600",children:(e=>{let t=Math.floor(e/3600),a=Math.floor(e%3600/60);return"".concat(t,":").concat(a,":").concat(e%60)})(r)})]})]})]})]})]}),(0,s.jsx)("div",{className:"w-full lg:w-1/3 mt-8 lg:mt-0",children:(0,s.jsx)("main",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Lessons"}),(0,s.jsx)("div",{className:"space-y-4",children:t&&t.baihocs.map(e=>(0,s.jsxs)(O,{as:"div",className:"border rounded-lg bg-white shadow",children:[(0,s.jsx)("h3",{className:"flow-root",children:(0,s.jsxs)(F,{className:"flex w-full justify-between items-center px-4 py-3 text-left text-sm font-medium text-gray-800 hover:bg-gray-50 rounded-t-lg",children:[(0,s.jsx)("span",{className:"font-medium",children:e.ten}),(0,s.jsxs)("span",{className:"ml-6 flex items-center",children:[(0,s.jsx)(R,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:hidden"}),(0,s.jsx)(M,{"aria-hidden":"true",className:"h-5 w-5 text-gray-500 group-data-[open]:block hidden"})]})]})}),(0,s.jsx)(B,{className:"px-4 py-2",children:(0,s.jsx)("div",{className:"space-y-2",children:e.video.map(e=>{var t;let a=null!==(t=m[e.id])&&void 0!==t&&t;return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{id:"check-".concat(e.id),"aria-pressed":a,className:"h-4 w-4 border-2 rounded ".concat(a?"bg-blue-600 border-blue-600":"bg-indigo-600 border-indigo-600"," flex items-center justify-center"),style:{zIndex:10,position:"relative"},children:a?"✔":""}),(0,s.jsxs)("div",{className:"flex justify-between items-center cursor-pointer ml-2 w-full px-2 py-1 rounded hover:bg-gray-100",onClick:()=>w(e.url_link,e.id),children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e.ten}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:e.thoiluong})]}),(0,s.jsx)("span",{className:"ml-2 text-sm font-medium",children:a?"Đ\xe3 xem":"Chưa xem"})]},e.id)})})})]},e.id))})]})})})]})})}},28424:(e,t,a)=>{a.d(t,{U1:()=>r,fT:()=>n,qh:()=>s,x$:()=>o});let r=async()=>{try{let e=await fetch("http://huuphuoc.id.vn/api/allkhoahoc");if(!e.ok)throw Error("Failed to fetch courses");return await e.json()}catch(e){throw console.error("Error fetching courses:",e),e}},s=async e=>{let t=await fetch("".concat("http://huuphuoc.id.vn/api/Khoahocchitiet/".concat(e)));if(!t.ok)throw Error("Failed to fetch courses");return t.json()},n=async()=>{let e=new URLSearchParams(window.location.search).get("id");console.log("id_khoahoc",e);let t=JSON.parse(localStorage.getItem("data"));if(!e)throw Error("Course ID not found in URL");try{let a=await fetch("".concat("http://huuphuoc.id.vn/api/ThemKhoaHocDaHoc"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_khoahoc:e,id_nguoidung:t.id})});if(!a.ok){let e=await a.text();throw Error("Failed to fetch certificate: ".concat(a.status," ").concat(a.statusText," - ").concat(e))}return a.json()}catch(e){throw console.error("Error:",e),e}},o=async()=>{let e=new URLSearchParams(window.location.search).get("id"),t=await fetch("".concat("http://huuphuoc.id.vn/api/GiangVienKhoaHocHienThi/".concat(e)));if(!t.ok)throw Error("Failed to fetch courses");return t.json()}}}]);