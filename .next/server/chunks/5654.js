"use strict";exports.id=5654,exports.ids=[5654],exports.modules={95654:(e,r,a)=>{a.d(r,{default:()=>b});var t=a(45512),i=a(58009),o=a(88345),n=a(12646),s=a(3636),l=a(95529),d=a(23668),c=a(95935),h=a(72953),g=a(78460),u=a(43998),m=a(96335),p=a(95989),y=a(7545),x=a(36865),w=a(44750);let f=(0,y.P)(o.a),j=(0,n.oY)({colors:{primary:"rgb(50, 173, 230)"}}),S=()=>{localStorage.getItem("data")||localStorage.setItem("data",JSON.stringify({giangvien:{id:1,name:"Default Giangvien"}})),localStorage.getItem("dataForm")||localStorage.setItem("dataForm",JSON.stringify({id_magiamgia:null}))},b=()=>{let[e,r]=(0,i.useState)([]),[a,n]=(0,i.useState)(null),[y,b]=(0,i.useState)(""),[v,N]=(0,i.useState)(""),[G,E]=(0,i.useState)(""),[k,F]=(0,i.useState)(!1);(0,i.useEffect)(()=>{S(),(async()=>{try{let e=await (0,x.NI)();r(e)}catch(e){w.oR.error("Failed to fetch data.")}})()},[]);let C=e=>{n(r=>r===e?null:e)},O=async()=>{if(a)try{let e=JSON.parse(localStorage.getItem("dataForm"))||{};e.id_magiamgia=a,localStorage.setItem("dataForm",JSON.stringify(e)),await (0,x.av)(a),w.oR.success("Coupon ID sent successfully!")}catch(e){w.oR.error("Error sending coupon ID.")}else w.oR.info("No coupon selected.")},I=e.filter(e=>{let r=!k||e.giamgia>=50;return(""===y||e.giamgia>=y)&&(""===v||e.luotsudung>=v)&&(""===G||new Date(e.ngaybatdau)<=new Date(G)&&new Date(e.ngayketthuc)>=new Date(G))&&r});return(0,t.jsxs)(s.s,{theme:j,children:[(0,t.jsxs)(l.m,{maxW:"full",height:"100vh",py:8,bg:"gray.50",position:"relative",overflowY:"auto",children:[(0,t.jsx)(d.D,{as:"h2",size:"lg",mb:6,color:"primary",textAlign:"center",children:"Danh s\xe1ch M\xe3 Giảm Gi\xe1 Kh\xf3a Học"}),(0,t.jsxs)(o.a,{mb:6,px:4,children:[(0,t.jsxs)(c.l,{placeholder:"Filter by discount percentage",value:y,onChange:e=>b(e.target.value),mb:4,children:[(0,t.jsx)("option",{value:"",children:"All"}),(0,t.jsx)("option",{value:"10",children:"10% or more"}),(0,t.jsx)("option",{value:"20",children:"20% or more"}),(0,t.jsx)("option",{value:"30",children:"30% or more"})]}),(0,t.jsxs)(c.l,{placeholder:"Filter by user count",value:v,onChange:e=>N(e.target.value),mb:4,children:[(0,t.jsx)("option",{value:"",children:"All"}),(0,t.jsx)("option",{value:"100",children:"100 or more"}),(0,t.jsx)("option",{value:"200",children:"200 or more"}),(0,t.jsx)("option",{value:"300",children:"300 or more"})]}),(0,t.jsx)(h.p,{type:"date",placeholder:"Filter by date",value:G,onChange:e=>E(e.target.value),mb:4}),(0,t.jsx)(g.S,{isChecked:k,onChange:e=>F(e.target.checked),mb:4,children:"Chỉ hiển thị khuyến m\xe3i tốt nhất (>= 50%)"})]}),(0,t.jsx)(u.r,{columns:{base:1,sm:2,md:3,lg:4},spacing:6,px:4,children:I.map(e=>(0,t.jsxs)(f,{bg:"white",shadow:"lg",rounded:"xl",p:4,position:"relative",onClick:()=>C(e.id),cursor:"pointer",whileHover:{scale:1.1},transition:{duration:.3},border:"2px solid gray",children:[a===e.id&&(0,t.jsx)(o.a,{as:"i",className:"bi bi-check-circle-fill",position:"absolute",top:4,right:2,color:"green.500",fontSize:"32px"}),(0,t.jsxs)(o.a,{mt:4,color:"gray.800",children:[(0,t.jsxs)(m.E,{fontWeight:"bold",fontSize:"md",children:[(0,t.jsx)("i",{className:`bi ${a===e.id?"bi-tag-fill":"bi-tag"}`,style:{marginRight:"8px"}}),"M\xe3 số: ",e.maso]}),(0,t.jsxs)(m.E,{fontSize:"md",children:[(0,t.jsx)("i",{className:"bi bi-percent",style:{marginRight:"8px"}}),"Giảm gi\xe1: ",e.giamgia,"%"]}),(0,t.jsxs)(m.E,{fontSize:"md",children:[(0,t.jsx)("i",{className:"bi bi-people",style:{marginRight:"8px"}}),"Lượt sử dụng: ",e.luotsudung]}),(0,t.jsxs)(m.E,{fontSize:"md",children:[(0,t.jsx)("i",{className:"bi bi-person-check",style:{marginRight:"8px"}}),"Sử dụng hiện tại: ",e.sudunghientai]}),(0,t.jsxs)(m.E,{fontSize:"md",children:[(0,t.jsx)("i",{className:"bi bi-calendar-event",style:{marginRight:"8px"}}),"Ng\xe0y bắt đầu: ",e.ngaybatdau]}),(0,t.jsxs)(m.E,{fontSize:"md",children:[(0,t.jsx)("i",{className:"bi bi-calendar-x",style:{marginRight:"8px"}}),"Ng\xe0y kết th\xfac: ",e.ngayketthuc]})]})]},e.id))}),(0,t.jsx)(o.a,{textAlign:"center",mt:6,children:(0,t.jsx)(p.$,{colorScheme:"blue",onClick:O,children:"Public"})})]}),(0,t.jsx)(w.N9,{})]})}},36865:(e,r,a)=>{a.d(r,{$2:()=>l,NI:()=>o,WJ:()=>s,av:()=>t,qC:()=>n,sL:()=>i});let t=async e=>{let r=new URLSearchParams(window.location.search).get("id");try{let a=await fetch("http://huuphuoc.id.vn/api/addMaGiamGiaKhoaHoc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_khoahoc:r,id_magiamgia:e})});if(!a.ok)throw Error("Failed to add MaGiamGia");return a.json()}catch(e){throw console.error("Fetch error:",e),Error("Network error or server is down")}},i=async()=>{try{let e=await fetch("http://huuphuoc.id.vn/api/showAllMaGiamGiaKhoaHoc");if(!e.ok)throw Error("Failed to fetch MaGiamGia data");return e.json()}catch(e){throw console.error("Fetch error:",e),Error("Network error or server is down")}},o=async()=>{try{let e=await fetch("http://huuphuoc.id.vn/api/showAllMaGiamGia");if(!e.ok)throw Error("Failed to fetch MaGiamGia data");return e.json()}catch(e){throw console.error("Fetch error:",e),Error("Network error or server is down")}},n=async e=>{let r=localStorage.getItem("data");if(!r)throw Error("User not authenticated");let a=JSON.parse(r);try{let r=await fetch("http://huuphuoc.id.vn/api/addNguoiDungMaGiamGia",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trangthai:"Chưa sử dụng",dasudunghientai:"0",id_nguoidung:a.id,id_magiamgia:e.id_magiamgia})});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to add MaGiamGia")}return r.json()}catch(e){throw console.error("Fetch error:",e),Error(e.message||"Network error or server is down")}},s=async()=>{let e=JSON.parse(localStorage.getItem("data"));if(!e||!e.id)throw Error("User data is missing or invalid");try{let r=await fetch("http://huuphuoc.id.vn/api/showAllNguoiDungMaGiamGia",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_nguoidung:e.id})});if(!r.ok)throw Error(`Server error: ${r.statusText}`);return r.json()}catch(e){throw console.error("Fetch error:",e),Error("Network error or server is down")}},l=async()=>{let e=localStorage.getItem("data"),r=localStorage.getItem("appliedCoupons");if(!e)throw Error("User not authenticated");if(!r)throw Error("No applied coupons found");try{let a=JSON.parse(e),t=r?JSON.parse(r):[];if(!a.id||!t[0]?.id_magiamgia)throw Error("Invalid user or coupon data");let i=await fetch("http://huuphuoc.id.vn/api/TinhMaGiamGia",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_nguoidung:a.id,id_magiamgia:t[0].id_magiamgia})});if(!i.ok){let e=await i.json();throw Error(e.message||"Failed to add MaGiamGia")}return i.json()}catch(e){throw console.error("Fetch error:",e),Error(e.message||"Network error or server is down")}}}};